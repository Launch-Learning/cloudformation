{
	"AWSTemplateFormatVersion": "2010-09-09",
	"Description": "Reference Architecture to host Java application on AWS - Creates Route 53 record set (if selected)",
	"Metadata": {
		"AWS::CloudFormation::Interface": {
			"ParameterGroups": [
				{
					"Label": {
						"default": "Route 53 Parameters"
					},
					"Parameters": [
						"DnsEndpoint",
						"DnsHostId",
						"DomainName",
						"SubdomainName"
					]
				}
			],
			"ParameterLabels": {
				"DnsEndpoint": {
					"default": "Elastic Beastalk enviroment domain name"
				},
				"DnsHostId": {
					"default": "Elastic Beanstalk Route 53 Hosted Zone ID"
				},
				"DomainName": {
					"default": "Route 53 Hosted Zone Name"
				},
				"SubdomainName": {
					"default": "Subdomain to add to Route 53 Hosted Zone"
				}
			}
		}
	},
	"Parameters": {
		"DnsEndpoint": {
			"AllowedPattern": "^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
			"Description": "For instance launch-lrs-demo.eba-svmpq9fa.us-east-1.elasticbeanstalk.com",
			"Type": "String"
		},
		"DnsHostId": {
			"AllowedPattern": "^[A-Z0-9]{14}$",
			"Description": "See https://docs.aws.amazon.com/general/latest/gr/elasticbeanstalk.html for possible values",
			"Type": "String"
		},
		"DomainName": {
			"AllowedPattern": "^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
			"Description": "For instance example.com",
			"Type": "String"
		},
		"SubdomainName": {
			"AllowedPattern": "^(?!http)(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\\-]*[a-zA-Z0-9])\\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\\-]*[A-Za-z0-9])$",
			"Description": "For instance www",
			"Type": "String"
		}
	},
	"Resources": {
		"RecordSet": {
			"Type": "AWS::Route53::RecordSetGroup",
			"Properties": {
				"HostedZoneName": {
					"Fn::Join": [
						"",
						[
							{
								"Ref": "DomainName"
							},
							"."
						]
					]
				},
				"RecordSets": [
					{
						"Name": {
							"Fn::Join": [
								"",
								[
									{
										"Ref": "SubdomainName"
									},
									".",
									{
										"Ref": "DomainName"
									},
									"."
								]
							]
						},
						"Type": "A",
						"AliasTarget": {
							"DNSName": {
								"Ref": "DnsEndpoint"
							},
							"EvaluateTargetHealth": false,
							"HostedZoneId": {
								"Ref": "DnsHostId"
							}
						}
					}
				]
			}
		}
	}
}